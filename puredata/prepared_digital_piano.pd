#N canvas -8 -8 1920 1037 10;
#X declare -lib ceammc;
#X declare -lib zexy;
#X declare -lib cyclone;
#X obj 581 227 notein;
#X text 628 226 pitch \, velocity \, channel;
#N canvas 437 266 450 300 get_key_key_velocity 0;
#X obj 7 35 buddy 2;
#X obj 8 98 pack f f f;
#X obj 8 63 buddy 2;
#X obj 6 8 inlet;
#X obj 149 8 inlet;
#X obj 6 132 outlet;
#X text 191 8 velocity;
#X text 45 9 key;
#X text 62 130 outputs: key key velocity - 62 62 121;
#X connect 0 0 2 0;
#X connect 0 0 2 1;
#X connect 0 1 1 2;
#X connect 1 0 5 0;
#X connect 2 0 1 0;
#X connect 2 1 1 1;
#X connect 3 0 0 0;
#X connect 4 0 0 1;
#X restore 581 297 pd get_key_key_velocity;
#N canvas 473 50 942 1010 output 0;
#X obj 350 471 t b;
#X obj 350 418 f;
#X obj 350 496 f;
#X msg 464 495 0;
#X obj 350 448 moses 1;
#X obj 464 467 t b f;
#X obj 430 428 moses 1;
#X obj 29 96 dbtorms;
#X obj 85 169 inlet~;
#X msg 120 351 \; pd dsp 1;
#X obj 29 169 line~;
#X obj 64 241 *~;
#X obj 79 271 dac~;
#X obj 29 126 pack 0 50;
#X text 121 145 audio in;
#X text 173 446 test if less than 1 -->;
#X text 139 473 if true convert to bang -->;
#X text 100 95 <-- convert from dB to linear units;
#X obj 347 351 bng 15 250 50 0 empty empty mute -34 5 0 12 -262144
-1 -1;
#X text 118 125 <-- make a ramp to avoid clicks or zipper noise;
#X obj 148 169 inlet~;
#X obj 111 239 *~;
#X text 400 372 MUTE logic:;
#X obj 280 163 r \$0-master-lvl;
#X obj 350 522 s \$0-master-lvl;
#X obj 189 357 s \$0-master-out;
#X obj 29 70 r \$0-master-out;
#X obj 399 399 r \$0-master-out;
#X text 60 9 Level control abstraction \, used in many of the Pd example
patches. The "level" and "mute" controls show up on the parent \, calling
patch.;
#X text 101 499 previous nonzero master-lvl -->;
#X text 173 403 recall previous;
#X text 173 421 value of master-lvl -->;
#X text 23 325 automatically start DSP -->;
#X obj 85 191 hip~ 3;
#X obj 147 191 hip~ 3;
#X obj 320 237 vsl 35 95 0 100 0 0 empty empty Volume 0 -9 0 10 -262144
-1 -1 9400 1;
#X obj 477 112 inlet;
#X obj 443 186 loadbang;
#X msg 443 211 100;
#X connect 0 0 2 0;
#X connect 1 0 4 0;
#X connect 2 0 24 0;
#X connect 3 0 24 0;
#X connect 4 0 0 0;
#X connect 4 1 5 0;
#X connect 5 0 3 0;
#X connect 6 1 2 1;
#X connect 7 0 13 0;
#X connect 8 0 33 0;
#X connect 10 0 21 0;
#X connect 10 0 11 0;
#X connect 11 0 12 0;
#X connect 13 0 10 0;
#X connect 18 0 1 0;
#X connect 20 0 34 0;
#X connect 21 0 12 1;
#X connect 23 0 35 0;
#X connect 26 0 7 0;
#X connect 27 0 1 1;
#X connect 27 0 6 0;
#X connect 33 0 11 1;
#X connect 34 0 21 1;
#X connect 35 0 9 0;
#X connect 35 0 25 0;
#X connect 36 0 35 0;
#X connect 37 0 38 0;
#X connect 38 0 35 0;
#X coords 0 0 1 1 65 170 1 300 200;
#X restore 114 222 pd output;
#X obj 13 176 sub/rje_limiter~;
#X obj 212 175 sub/rje_limiter~;
#X obj 13 143 catch~ individual_notes_left;
#X obj 212 143 catch~ individual_notes_right;
#X obj 572 8 sub/rje_set_constants;
#X obj 581 327 sub/rje_route_notes~;
#X obj 756 297 sub/rje_calculate_notes_per_second;
#X text 10 9 To setup: Help - Find externals \, add ceammc \, cyclone
\, zexy - then add their paths to preferences;
#X obj 411 7 declare -lib ceammc;
#X obj 411 47 declare -lib zexy;
#X obj 411 27 declare -lib cyclone;
#X text 581 194 HANDLE NOTE PRESSED;
#X text 1066 200 HANDLE PEDAL;
#X text 1130 265 is pedal on;
#X obj 1070 233 sub/rje_is_pedal_on;
#X obj 1070 265 nbx 5 14 -1e+037 1e+037 0 0 empty empty empty 0 -8
0 10 -262144 -1 -1 0 256;
#X connect 0 0 2 0;
#X connect 0 1 2 1;
#X connect 0 1 10 0;
#X connect 2 0 9 0;
#X connect 4 0 3 0;
#X connect 5 0 3 1;
#X connect 6 0 4 0;
#X connect 7 0 5 0;
#X connect 18 0 19 0;
